pipeline {
  agent {
    node {
        label 'master'
    }
  }
  parameters{
      string(name:'UIIPAddress', defaultValue: '', description: 'Please enter the UI ip address')
      string(name:'BankendIPAddress', defaultValue: '', description: 'Please enter the Backend ip address')
      string(name:'instanceUser', defaultValue: 'ubuntu', description: 'Please enter the username')
  }
  stages {
    stage('Clean Worspace'){
        steps{
            deleteDir()
        }
    }
    stage('Install Jar') {
      steps {
        sshagent(['stocks']) {
           sh '''
            ssh -o StrictHostKeyChecking=no -tt ${instanceUser}@${UIIPAddress} << EOF 
            git clone https://github.com/kumarRaj/stocks.git
            cd stocks/stocks-ui
            npm install
            REACT_APP_SERVER_HOST=${BankendIPAddress} npm start&
            exit
            EOF
           '''
        }
      }
    }
  }
}